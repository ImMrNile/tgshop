// lib/avatarUtils.ts
// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–æ–¥–∑–∏-–∞–≤–∞—Ç–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

interface EmojiAvatar {
  emoji: string;
  backgroundColor: string;
}

// –°–ø–∏—Å–æ–∫ —ç–º–æ–¥–∑–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å)
const emojis = ['üòä', 'üòé', 'ü§©', 'üöÄ', 'üåü', 'üí°', 'üî•', 'üåà', 'üíé', 'üëë', 'ü§ñ', 'ü¶ä', 'üêª', 'üêº', 'üêØ', 'ü¶Å', 'ü¶â', 'ü¶Ñ', 'üê≤', 'üêô'];

// –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ –¥–ª—è —Ñ–æ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞
const colors = [
  '#8a2be2', // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
  '#1e90ff', // –°–∏–Ω–∏–π
  '#10b981', // –ó–µ–ª–µ–Ω—ã–π
  '#f59e0b', // –û—Ä–∞–Ω–∂–µ–≤—ã–π
  '#ef4444', // –ö—Ä–∞—Å–Ω—ã–π
  '#6b7280', // –°–µ—Ä—ã–π
  '#00bcd4', // –ì–æ–ª—É–±–æ–π
  '#ffc107', // –ñ–µ–ª—Ç—ã–π
  '#9c27b0', // –ü—É—Ä–ø—É—Ä–Ω—ã–π
  '#009688', // –ë–∏—Ä—é–∑–æ–≤—ã–π
];

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —ç–º–æ–¥–∑–∏-–∞–≤–∞—Ç–∞—Ä –∏ —Ü–≤–µ—Ç —Ñ–æ–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
 * @param userId ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å—Ç—Ä–æ–∫–∞).
 * @param name –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –≤—ã–±–æ—Ä–∞ —ç–º–æ–¥–∑–∏ –ø–æ –ø–µ—Ä–≤–æ–π –±—É–∫–≤–µ, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ).
 * @returns –û–±—ä–µ–∫—Ç —Å —ç–º–æ–¥–∑–∏ –∏ —Ü–≤–µ—Ç–æ–º —Ñ–æ–Ω–∞.
 */
export function generateEmojiAvatar(userId: string, name: string | null | undefined): EmojiAvatar {
  let seed = 0;
  if (name && name.length > 0) {
    seed = name.charCodeAt(0); // –ò—Å–ø–æ–ª—å–∑—É–µ–º ASCII-–∫–æ–¥ –ø–µ—Ä–≤–æ–π –±—É–∫–≤—ã –∫–∞–∫ —á–∞—Å—Ç—å seed
  } else {
    // –ï—Å–ª–∏ –∏–º–µ–Ω–∏ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ö—ç—à –æ—Ç userId
    for (let i = 0; i < userId.length; i++) {
      seed += userId.charCodeAt(i);
    }
  }

  const emojiIndex = seed % emojis.length;
  const colorIndex = (seed + userId.length) % colors.length; // –î–æ–±–∞–≤–ª—è–µ–º userId.length –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è

  return {
    emoji: emojis[emojiIndex],
    backgroundColor: colors[colorIndex],
  };
}